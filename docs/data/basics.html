<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Preparing your data - Lace Documentation</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />
        <script src="https://cdn.plot.ly/plotly-2.18.0.min.js"></script>
        <style>
            .plotly-graph-div {
                aspect-ratio: 1 / 1;
            }
        </style>

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././theme/catppuccin.css">
        <link rel="stylesheet" href=".././theme/catppuccin-highlight.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../install.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../workflow/workflow.html"><strong aria-hidden="true">3.</strong> The lace workflow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../workflow/codebook.html"><strong aria-hidden="true">3.1.</strong> Create and edit a codebook</a></li><li class="chapter-item expanded "><a href="../workflow/model.html"><strong aria-hidden="true">3.2.</strong> Run/train/fit a model</a></li><li class="chapter-item expanded "><a href="../workflow/analysis.html"><strong aria-hidden="true">3.3.</strong> Conduct an analysis</a></li></ol></li><li class="chapter-item expanded "><a href="../pcc/pcc.html"><strong aria-hidden="true">4.</strong> Probabilistic Cross-Categorization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pcc/depprob.html"><strong aria-hidden="true">4.1.</strong> Dependence Probability</a></li><li class="chapter-item expanded "><a href="../pcc/mi.html"><strong aria-hidden="true">4.2.</strong> Mutual Information</a></li><li class="chapter-item expanded "><a href="../pcc/rowsim.html"><strong aria-hidden="true">4.3.</strong> Row similarity</a></li><li class="chapter-item expanded "><a href="../pcc/pred.html"><strong aria-hidden="true">4.4.</strong> Prediction & Imputation</a></li><li class="chapter-item expanded "><a href="../pcc/surp.html"><strong aria-hidden="true">4.5.</strong> Surprisal</a></li><li class="chapter-item expanded "><a href="../pcc/simulate.html"><strong aria-hidden="true">4.6.</strong> Data Simulation</a></li><li class="chapter-item expanded "><a href="../pcc/inouttable.html"><strong aria-hidden="true">4.7.</strong> In- and out-of-table operations</a></li></ol></li><li class="chapter-item expanded "><a href="../data/basics.html" class="active"><strong aria-hidden="true">5.</strong> Preparing your data</a></li><li class="chapter-item expanded "><a href="../codebook-ref.html"><strong aria-hidden="true">6.</strong> Codebook reference</a></li><li class="chapter-item expanded "><a href="../appendix/appendix.html"><strong aria-hidden="true">7.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix/stats-primer.html"><strong aria-hidden="true">7.1.</strong> Stats primer</a></li><li class="chapter-item expanded "><a href="../appendix/glossary.html"><strong aria-hidden="true">7.2.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../appendix/references.html"><strong aria-hidden="true">7.3.</strong> Refernces</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lace Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/promised-ai/braid2lace" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="preparing-your-data-for-lace"><a class="header" href="#preparing-your-data-for-lace">Preparing your data for Lace</a></h1>
<p>Compared with many other machine learning tools, lace has very few requirements
for data: data columns may be integer, continuous, or categorical string types;
empty cells do not not need to be filled in; and the table must contain a row
index column labeled <code>ID</code>.</p>
<p>Note that for categorical columns, lace currently supports up to 256 unique
values.</p>
<h2 id="supported-data-types-for-inference"><a class="header" href="#supported-data-types-for-inference">Supported data types for inference</a></h2>
<p>Lace supports several data types, and more can be supported (with some work).</p>
<h3 id="continuous-data"><a class="header" href="#continuous-data">Continuous data</a></h3>
<p>Continuous columns are modeled as mixtures of <a href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian
distributions</a>. Find an
explanation of the parameters in the <a href="/codebook-ref.html#continuous">codebook</a></p>
<h3 id="categorical-data"><a class="header" href="#categorical-data">Categorical data</a></h3>
<p>Continuous columns are modeled as mixtures of <a href="https://en.wikipedia.org/wiki/Categorical_distribution">categorical
distributions</a>. Find an
explanation of the parameters in the <a href="/codebook-ref.html#categorical">codebook</a>. </p>
<h3 id="count-data"><a class="header" href="#count-data">Count data</a></h3>
<p>Support exists for a count data type, which is modeled as a mixture of
<a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poission distirbutions</a>,
but there are some drawbacks, which make it best to convert the data to
continuous.</p>
<ul>
<li>The Poisson distribution is a single parameter model so the location and
variance of the mixture components cannot be controlled individually. In
the Poisson model, higher magnitude means higher variance.</li>
<li>The hyper prior for count data is finicky and can often cause
underflow/overflow errors when the underlying data do not look like Poisson
distributions.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> If you use Count data do so because you know that the underlying
mixture components will be Poisson like and be sure the set the prior and
unset the hyperprior in the <a href="/codebook-ref.html">codebook</a></p>
</blockquote>
<h2 id="preparing-your-data-for-lace-1"><a class="header" href="#preparing-your-data-for-lace-1">Preparing your data for Lace</a></h2>
<p>Lace is pretty forgiving when it comes to data. You can have missing values,
string values, and numerical values all in the same table; but there are some
rules that your data must follow for the platform to pick up on things. Here
you will learn how to make sure that Lace understands your data properly.</p>
<h3 id="accepted-formats"><a class="header" href="#accepted-formats">Accepted formats</a></h3>
<p>Lace currently accepts the following data formats</p>
<ul>
<li>CSV</li>
<li>CSV.gz (gzipped CSV)</li>
<li>parquet</li>
<li>IPC (feather v2)</li>
<li>JSON (as output by the pandas function <code>df.to_json('mydata.json)</code>)</li>
<li>JSON Lines</li>
</ul>
<h3 id="using-a-string-based-data-format"><a class="header" href="#using-a-string-based-data-format">Using a string-based data format</a></h3>
<p>Formatting your data properly will help the platform understand your data.
Under the hood, Lace uses <code>polars</code> for reading data formats into a <code>DataFrame</code>.
For mote information about i/o in <code>polars</code>, see <a href="https://pola-rs.github.io/polars/py-polars/html/reference/io.html">the polars API
documentation</a>.</p>
<p>Here are the rules:</p>
<ol>
<li>Real-valued (continuous data) cells must have decimals.</li>
<li>Integer-values cells, whether count or categorical, must not have decimals.</li>
<li>Categorical data cells may be integers (up to 255) or string values</li>
<li>In a CSV, missing cells should be empty</li>
<li>A row index is required. The index label should be 'ID'.</li>
</ol>
<p>Not following these rules will confuse the <a href="/basics/codebook">codebook</a> and
could cause parsing errors.</p>
<h3 id="row-and-column-names"><a class="header" href="#row-and-column-names">Row and column names</a></h3>
<p>Row and column indices or names must be strings. If you were to create a
codebook from a csv with integer row and column indices, Lace would convert
them to strings.</p>
<h3 id="tips-on-creating-valid-data-with-pandas"><a class="header" href="#tips-on-creating-valid-data-with-pandas">Tips on creating valid data with <code>pandas</code></a></h3>
<p>When reading data from a CSV, Pandas will convert integer columns with missing
cells to float values since floats can represent <code>NaN</code>, which is how pandas
represents missing data. You have a couple of options for saving your CSV file
with both missing cells and properly formatted integers:</p>
<p>You can coerce the types to <code>Int64</code>, which is basically Int plus <code>NaN</code>, and
then write to CSV.</p>
<pre><code class="language-python">df['my_int_col'] = df['my_int_col'].astype('Int64')
df.to_csv('mydata.csv', index_label='ID')
</code></pre>
<p>If you have a lot of columns or particularly long columns, you might find it
<em>much</em> faster just to reformat as you write to the csv, in which case you can
use the <code>float_format</code> option in <code>DataFrame.to_csv</code></p>
<pre><code class="language-python">df.to_csv('mydata.csv', index_label='ID', float_format='%g')
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pcc/inouttable.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../codebook-ref.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pcc/inouttable.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../codebook-ref.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
